clear all;
clear all;
clc;
%%
% Global Variables Used
audio = "sa1.F.wav";
W_ms = 15;

%%
[SigTime,Fs] = audioread(audio);
SigTime = SigTime(1:end,1);
len = length(SigTime);

SqVal = SigTime.*SigTime;
ZC = sign(-SigTime(1:end-1).*SigTime(2:end));
ZC(ZC<0) = 0 ;

Avg_ZC = sum(ZC)/len;
Avg_SE = sum(SqVal)/len;


fprintf("Avg Zero Crossing = %d, Energy = %d\n",Avg_ZC,Avg_SE);

W_len = int32((W_ms/1000.0)*Fs);
ZC_Win = Avg_ZC*W_len;
max =0;
VAD_ZC = zeros(1,len);
VAD_SE = zeros(1,len);
for i = 1:50:len-W_len-5
    TZC = sum(ZC(i:i+W_len) );
    TZC_avg = TZC/double(W_len);
    TSE = sum(SqVal(i:i+W_len) );
    TSE_avg = TSE / double(W_len);
    
    if (TZC < 2*Avg_ZC)
        VAD_ZC(i:i+W_len)=1;
    end
    if TSE > 5 * Avg
    end
end


